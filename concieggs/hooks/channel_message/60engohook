#!/usr/bin/env perl
use v5.20;
use warnings;
use utf8;

use utf8::all;
use Env qw/EGGS_BODY/;

system("shuttingUp || talkingToConcieggs");
exit if ($? >> 8) == 0;

# en + en = to
my @rules = (
    {
        en   => 'en',
        to   => 'to',
        puns => [
            "den er go'",
            "værsgo'",
            "kan du tro",
            "prøv at glo",
        ],
    },
    {
        en   => 'to',
        to   => 'fire',
        puns => [
            "det' det jeg siger",
            "pi'rne skriger",
        ],
    },
    {
        en   => 'ni',
        to   => 'atten',
        puns => [
            "så for sat'n",
            "jeg løfter hatten",
        ],
    },
    {
        en   => 'ti',
        to   => 'tyve',
        puns => [
            "uden at lyve",
        ],
    },
);

for my $rule (@rules) {
    my $left = $rule->{en} . '\s+' . $rule->{en};
    my $right = $rule->{to};

    my $body = $EGGS_BODY =~ s/$left/$right/gr;
    next if ($body eq $EGGS_BODY);

    my $pun = $rule->{puns}->[rand @{$rule->{puns}}];
    printf("%s og %s gi'r %s; %s: %s\n", ucfirst $rule->{en}, $rule->{en}, $rule->{to}, $pun, $body);
    exit(0);
}
