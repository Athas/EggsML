#!/bin/sh
# 
# Meld dig til at spise med på et givent tidspunkt.  Tidspunktet er
# altid i fremtiden, og pt. aldrig mere end 24 timer fremme.  Således
# kan du derfor kun melde dig til spisning i dag eller i morgen.

if [ $# -lt 1 ]; then
    echo "Brug: eggsml <tidspunkt>"
else
    alias=$(randomName $EGGS_USER)
    time=$(dateToTime $1)
    if [ "$time" != "" ]; then
        if [ "$alias" != "" ]; then
            if [ "$(isInEggs $1 $alias)" != "" ]; then
                echo "$alias spiser allerede med $(timeToDate $time)!"
            elif addToEggs "$1" "$alias"; then
                echo "Javel! $alias spiser med $(timeToDate $time)!"
            else
                exit 1
            fi
        else
            echo "Jeg kender dig ikke, $EGGS_USER!"
        fi
    else
        echo "Det tidspunkt giver ingen mening!"
    fi
fi
