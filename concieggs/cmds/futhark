#!/bin/sh
#
# Gotta go fast!

if [ $# = 0 ]; then
    (echo "Gotta go fast!";
     echo "Den ska' vær' travl!";
     echo "Macht schell!";
     echo "¡Más rápido!";
     echo "Enormi veloce!") | randomLine
else
    file=$(mktemp)
    rettype=$1
    shift;
    echo "fun $rettype main() = $@" > $file
    if [ "$(basename "$0")" = futhark-simplify ]; then
        futhark -s "$file" 2>&1
    else
        if futhark-c "$file" -o "$file.bin" 2>&1; then
            timeout 10 "$file.bin" 2>&1 || echo "$EGGS_USER: Det gik galt."
        fi
    fi
    rm -f "$file" "$file.bin"
fi
