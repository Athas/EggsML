#!/bin/sh
#
# This script is run on all non-command output from the IRC bot.

set -e

channel=$1
destuser=$2 # empty if it's not a 'user: message' message.

translate_example() {
    # Example.
    while read -r line; do
        echo "$line" | translate da ja da
    done
}

apply_db_filter() {
    # not done yet
    while read -r line; do
        cmd=''
        if [ $destuser ]; then
            cmd=$(dbRead outfilter_command_$destuser)
        fi
        if [ ! "$cmd" ]; then
            cmd=$(dbRead outfilter_command)
        fi
        if [ ! "$cmd" ]; then
            echo "$line"
            exit
        fi

        echo "$line" | $cmd
    done
}

apply_db_filter

#translate_example
